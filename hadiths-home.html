<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <title>Noor Al Huda â€” Hadiths</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">

  <script>
    // Theme handling
    if (localStorage.getItem("theme") === "dark") {
      document.documentElement.classList.add("dark-mode");
    }
    function toggleDarkMode() {
      document.documentElement.classList.toggle("dark-mode");
      localStorage.setItem(
        "theme",
        document.documentElement.classList.contains("dark-mode") ? "dark" : "light"
      );
      updateThemeIcon();
    }
    function updateThemeIcon() {
      const btn = document.getElementById("themeToggle");
      if (btn) {
        btn.textContent = document.documentElement.classList.contains("dark-mode") ? "â˜€ï¸" : "ğŸŒ™";
      }
    }
    function toggleMenu() {
      document.getElementById("mainNav").classList.toggle("open");
    }
  </script>

  <style>
    .search-bar {
      margin: 1rem auto;
      max-width: 480px;
      display: flex;
      gap: 0.5rem;
    }
    .search-bar input {
      flex: 1;
      padding: 0.6rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-size: 0.95rem;
      background: var(--card-bg);
      color: var(--text);
    }
    .search-bar button {
      padding: 0.6rem 1rem;
      border: none;
      border-radius: var(--radius);
      background: var(--green);
      color: #fff;
      font-weight: 600;
      cursor: pointer;
    }
    .search-bar button:hover { filter: brightness(1.06); }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 1rem;
      max-width: 1000px;
      margin: 1rem auto 2rem;
      padding: 0 1rem;
    }
    .card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }
    .card h4 {
      margin: 0;
      color: var(--text);
    }
    .card p {
      margin: 0;
      color: var(--muted);
      font-size: 0.95rem;
    }
    .card a {
      margin-top: 0.5rem;
      text-decoration: none;
      font-weight: 700;
      color: var(--green);
    }
    .card a:hover { text-decoration: underline; }

    .empty {
      text-align: center;
      color: var(--muted);
      margin-top: 1rem;
    }
  </style>
</head>

<body onload="updateThemeIcon()">
  <!-- Header -->
  <header>
    <div class="brand">
      <img src="logo.png.png" alt="Noor Al Huda Logo">
      <h1>Noor Al Huda <span class="arabic">Ù†ÙˆØ± Ø§Ù„Ù‡Ø¯Ù‰</span></h1>
    </div>

    <button class="hamburger" onclick="toggleMenu()">â˜°</button>

    <nav id="mainNav">
      <a href="quran.html">ğŸ“– Qurâ€™an</a>
      <a href="duas.html">ğŸ¤² Duas</a>
      <a href="hadiths-home.html" class="active">ğŸ“œ Hadiths</a>
      <a href="calendar.html">ğŸ“… Calendar</a>
      <a href="salah.html">ğŸ•Œ Salah</a>
      <a href="index.html" class="utility">ğŸ </a>
      <a href="settings.html" class="utility">âš™</a>
      <button class="btn utility" id="themeToggle" onclick="toggleDarkMode()">ğŸŒ™</button>
    </nav>
  </header>

  <!-- Main -->
  <main class="container">
    <h2 style="text-align:center;">Select a Hadith Book</h2>

    <!-- Search bar -->
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Search Hadith book by name (English or Arabic)" onkeydown="if(event.key==='Enter'){searchBooks()}">
      <button onclick="searchBooks()">Search</button>
    </div>

    <div class="grid" id="bookGrid"></div>
    <div class="empty" id="emptyState" style="display:none;">No books match your search.</div>
  </main>

  <!-- Footer -->
  <footer>
    Â© 2025 Noor Al Huda â€” Personal Islamic Companion (Wisdom thru Ahlul Bayt)
  </footer>

  <script>
    // Book definitions + routes (fixes the broken link generation)
    const books = [
      { id: "al-kafi", name_en: "Al-Kafi", name_ar: "Ø§Ù„ÙƒØ§ÙÙŠ", href: "alkafi.html" },
      { id: "man-la", name_en: "Man La Yahduruhu al-Faqih", name_ar: "Ù…Ù† Ù„Ø§ ÙŠØ­Ø¶Ø±Ù‡ Ø§Ù„ÙÙ‚ÙŠÙ‡", href: "man-la-yahduruhu.html" },
      { id: "tahdhib", name_en: "Tahdhib al-Ahkam", name_ar: "ØªÙ‡Ø°ÙŠØ¨ Ø§Ù„Ø£Ø­ÙƒØ§Ù…", href: "tahdhib.html" },
      { id: "istibsar", name_en: "Al-Istibsar", name_ar: "Ø§Ù„Ø§Ø³ØªØ¨ØµØ§Ø±", href: "istibsar.html" },
      { id: "nahj", name_en: "Nahj al-Balagha", name_ar: "Ù†Ù‡Ø¬ Ø§Ù„Ø¨Ù„Ø§ØºØ©", href: "nahj-al-balagha.html" },
      { id: "kitab-sulaim", name_en: "Kitab Sulaim bin Qays", name_ar: "ÙƒØªØ§Ø¨ Ø³Ù„ÙŠÙ… Ø¨Ù† Ù‚ÙŠØ³", href: "kitab-sulaim.html" },
      { id: "kitab-al-momin", name_en: "Kitab Al Momin", name_ar: "ÙƒØªØ§Ø¨ Ø§Ù„Ù…Ø¤Ù…Ù†", href: "kitab-al-momin.html" }
    ];

    const grid = document.getElementById("bookGrid");
    const emptyState = document.getElementById("emptyState");

    function normalizeArabic(str) {
      // Basic normalization: trim, unify Arabic alef forms
      return (str || "")
        .trim()
        .replace(/[Ø¥Ø£Ø¢]/g, "Ø§")
        .replace(/Ù‰/g, "ÙŠ")
        .replace(/Ø©/g, "Ù‡");
    }

    function renderBooks(list) {
      grid.innerHTML = "";
      emptyState.style.display = list.length ? "none" : "block";

      list.forEach(book => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <h4>${book.name_en}</h4>
          <p>${book.name_ar}</p>
          <a href="${book.href}">View Hadiths â†’</a>
        `;
        grid.appendChild(card);
      });
    }

    function searchBooks() {
      const queryRaw = document.getElementById("searchInput").value;
      const qEn = (queryRaw || "").toLowerCase().trim();
      const qAr = normalizeArabic(queryRaw);

      const filtered = books.filter(b => {
        const enMatch = b.name_en.toLowerCase().includes(qEn);
        const arMatch = normalizeArabic(b.name_ar).includes(qAr);
        return enMatch || arMatch;
      });

      renderBooks(filtered);
    }

    // Initial render
    renderBooks(books);
  </script>
</body>
</html>
